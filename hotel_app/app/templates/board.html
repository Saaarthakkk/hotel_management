{% extends 'base.html' %}
{% block content %}
<h1>Reservation Board</h1>
<form method="post" action="{{ url_for('bookings.search') }}">
    {{ search_form.hidden_tag() }}
    {{ search_form.guest_name.label }} {{ search_form.guest_name() }}
    {{ search_form.start_date.label }} {{ search_form.start_date() }}
    {{ search_form.end_date.label }} {{ search_form.end_date() }}
    <input type="submit" value="Search">
</form>
<table>
    <tr><th>ID</th><th>Room</th><th>User</th><th>Status</th><th>Action</th></tr>
    {% for b in bookings %}
    <tr>
        <td>{{ b.id }}</td>
        <td>{{ b.room.number }}</td>
        <td>{{ b.user.username }}</td>
        <td>{{ b.status }}</td>
        <td>
            {% if b.status == 'reserved' %}
            <a href="{{ url_for('bookings.check_in', bid=b.id) }}">Check In</a>
            <form method="post" action="{{ url_for('bookings.cancel_booking', bid=b.id) }}" style="display:inline;">
              <input type="submit" value="Cancel">
            </form>
            {% elif b.status == 'checked-in' %}
            <a href="{{ url_for('bookings.check_out', bid=b.id) }}">Check Out</a>
            {% endif %}
        </td>
    </tr>
    {% endfor %}
</table>
{% endblock %}

